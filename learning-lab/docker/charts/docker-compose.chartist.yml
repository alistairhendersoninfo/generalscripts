services:
  backend:
    build: ./backend
    environment:
      CLICKHOUSE_HOST: clickhouse
      CLICKHOUSE_PORT: 9000
      CLICKHOUSE_USER: analytics
      CLICKHOUSE_PASSWORD: analytics
      CLICKHOUSE_DATABASE: analytics
    networks: [lab]

  chartist-app:
    build: ./apps/chartist
    depends_on: [backend]
    networks: [lab]

  master:
    image: nginx:1.25-alpine
    depends_on:
      - backend
      - chartist-app
    volumes:
      - ./master-nginx/single/chartist.conf:/etc/nginx/conf.d/default.conf:ro
    ports:
      - 8111:80
    networks: [lab]

networks:
  lab:
    external: true
    name: learning-lab_docker_core_lab
